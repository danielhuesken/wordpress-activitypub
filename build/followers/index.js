(()=>{var e={942:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=o(e,l(a)))}return e}function l(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)n.call(e,a)&&e[a]&&(t=o(t,a));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,a),l.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.blocks,t=window.React,n=window.wp.primitives,r=(0,t.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(n.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})),l=window.wp.components,o=window.wp.element,i=window.wp.blockEditor,c=window.wp.data,s=window.wp.coreData,p=window.wp.i18n,u=window.wp.apiFetch;var m=a.n(u);const v=window.wp.url;var w=a(942),d=a.n(w);function b({active:e,children:a,page:n,pageClick:r,className:l}){const o=d()("wp-block activitypub-pager",l,{current:e});return(0,t.createElement)("a",{className:o,onClick:t=>{t.preventDefault(),!e&&r(n)}},a)}const g={outlined:"outlined",minimal:"minimal"};function f({compact:e,nextLabel:a,page:n,pageClick:r,perPage:l,prevLabel:o,total:i,variant:c=g.outlined}){const s=((e,t)=>{let a=[1,e-2,e-1,e,e+1,e+2,t];a.sort(((e,t)=>e-t)),a=a.filter(((e,a,n)=>e>=1&&e<=t&&n.lastIndexOf(e)===a));for(let e=a.length-2;e>=0;e--)a[e]===a[e+1]&&a.splice(e+1,1);return a})(n,Math.ceil(i/l)),p=d()("alignwide wp-block-query-pagination is-content-justification-space-between is-layout-flex wp-block-query-pagination-is-layout-flex",`is-${c}`,{"is-compact":e});return(0,t.createElement)("nav",{className:p},o&&(0,t.createElement)(b,{key:"prev",page:n-1,pageClick:r,active:1===n,"aria-label":o,className:"wp-block-query-pagination-previous block-editor-block-list__block"},o),!e&&(0,t.createElement)("div",{className:"block-editor-block-list__block wp-block wp-block-query-pagination-numbers"},s.map((e=>(0,t.createElement)(b,{key:e,page:e,pageClick:r,active:e===n,className:"page-numbers"},e)))),a&&(0,t.createElement)(b,{key:"next",page:n+1,pageClick:r,active:n===Math.ceil(i/l),"aria-label":a,className:"wp-block-query-pagination-next block-editor-block-list__block"},a))}function y(){return window._activityPubOptions||{}}function h({selectedUser:e,per_page:a,order:n,title:r,page:l,setPage:i,className:c="",followLinks:s=!0,followerData:u=!1}){const w="site"===e?0:e,[d,b]=(0,t.useState)([]),[g,h]=(0,t.useState)(0),[E,_]=(0,t.useState)(0),[x,C]=function(){const[e,a]=(0,t.useState)(1);return[e,a]}(),N=l||x,S=i||C,P=(0,o.createInterpolateElement)(/* translators: arrow for previous followers link */ /* translators: arrow for previous followers link */
(0,p.__)("<span>←</span> Less","activitypub"),{span:(0,t.createElement)("span",{className:"wp-block-query-pagination-previous-arrow is-arrow-arrow","aria-hidden":"true"})}),I=(0,o.createInterpolateElement)(/* translators: arrow for next followers link */ /* translators: arrow for next followers link */
(0,p.__)("More <span>→</span>","activitypub"),{span:(0,t.createElement)("span",{className:"wp-block-query-pagination-next-arrow is-arrow-arrow","aria-hidden":"true"})}),L=(e,t)=>{b(e),_(t),h(Math.ceil(t/a))};return(0,t.useEffect)((()=>{if(u&&1===N)return L(u.followers,u.total);const e=function(e,t,a,n){const{namespace:r}=y(),l=`/${r}/actors/${e}/followers`,o={per_page:t,order:a,page:n,context:"full"};return(0,v.addQueryArgs)(l,o)}(w,a,n,N);m()({path:e}).then((e=>L(e.orderedItems,e.totalItems))).catch((()=>{}))}),[w,a,n,N,u]),(0,t.createElement)("div",{className:"activitypub-follower-block "+c},(0,t.createElement)("h3",null,r),(0,t.createElement)("ul",null,d&&d.map((e=>(0,t.createElement)("li",{key:e.url},(0,t.createElement)(k,{...e,followLinks:s}))))),g>1&&(0,t.createElement)(f,{page:N,perPage:a,total:E,pageClick:S,nextLabel:I,prevLabel:P,compact:"is-style-compact"===c}))}function k({name:e,icon:a,url:n,preferredUsername:r,followLinks:o=!0}){const i=`@${r}`,c={};return o||(c.onClick=e=>e.preventDefault()),(0,t.createElement)(l.ExternalLink,{className:"activitypub-link",href:n,title:i,...c},(0,t.createElement)("img",{width:"40",height:"40",src:a.url,className:"avatar activitypub-avatar",alt:e}),(0,t.createElement)("span",{className:"activitypub-actor"},(0,t.createElement)("strong",{className:"activitypub-name"},e),(0,t.createElement)("span",{className:"sep"},"/"),(0,t.createElement)("span",{className:"activitypub-handle"},i)))}function E({name:e}){const{enabled:a}=y(),n=a?.site?"":(0,p.__)("It will be empty in other non-author contexts.","activitypub"),r=(0,p.sprintf)(/* translators: %1$s: block name, %2$s: extra information for non-author context */ /* translators: %1$s: block name, %2$s: extra information for non-author context */
(0,p.__)("This <strong>%1$s</strong> block will adapt to the page it is on, displaying the user profile associated with a post author (in a loop) or a user archive. %2$s","activitypub"),e,n).trim();return(0,t.createElement)(l.Card,null,(0,t.createElement)(l.CardBody,null,(0,o.createInterpolateElement)(r,{strong:(0,t.createElement)("strong",null)})))}(0,e.registerBlockType)("activitypub/followers",{edit:function({attributes:e,setAttributes:a,context:{postType:n,postId:r}}){const{order:u,per_page:m,selectedUser:v,title:w}=e,d=(0,i.useBlockProps)(),[b,g]=(0,o.useState)(1),f=[{label:(0,p.__)("New to old","activitypub"),value:"desc"},{label:(0,p.__)("Old to new","activitypub"),value:"asc"}],k=function({withInherit:e=!1}){const{enabled:t}=y(),a=t?.users?(0,c.useSelect)((e=>e("core").getUsers({who:"authors"}))):[];return(0,o.useMemo)((()=>{if(!a)return[];const n=[];return t?.site&&n.push({label:(0,p.__)("Site","activitypub"),value:"site"}),e&&t?.users&&n.push({label:(0,p.__)("Dynamic User","activitypub"),value:"inherit"}),a.reduce(((e,t)=>(e.push({label:t.name,value:`${t.id}`}),e)),n)}),[a])}({withInherit:!0}),_=e=>t=>{g(1),a({[e]:t})},x=(0,c.useSelect)((e=>{const{getEditedEntityRecord:t}=e(s.store),a=t("postType",n,r)?.author;return null!=a?a:null}),[n,r]);return(0,o.useEffect)((()=>{k.length&&(k.find((({value:e})=>e===v))||a({selectedUser:k[0].value}))}),[v,k]),(0,t.createElement)("div",{...d},(0,t.createElement)(i.InspectorControls,{key:"setting"},(0,t.createElement)(l.PanelBody,{title:(0,p.__)("Followers Options","activitypub")},(0,t.createElement)(l.TextControl,{label:(0,p.__)("Title","activitypub"),help:(0,p.__)("Title to display above the list of followers. Blank for none.","activitypub"),value:w,onChange:e=>a({title:e})}),k.length>1&&(0,t.createElement)(l.SelectControl,{label:(0,p.__)("Select User","activitypub"),value:v,options:k,onChange:_("selectedUser")}),(0,t.createElement)(l.SelectControl,{label:(0,p.__)("Sort","activitypub"),value:u,options:f,onChange:_("order")}),(0,t.createElement)(l.RangeControl,{label:(0,p.__)("Number of Followers","activitypub"),value:m,onChange:_("per_page"),min:1,max:10}))),"inherit"===v?x?(0,t.createElement)(h,{...e,page:b,setPage:g,followLinks:!1,selectedUser:x}):(0,t.createElement)(E,{name:(0,p.__)("Followers","activitypub")}):(0,t.createElement)(h,{...e,page:b,setPage:g,followLinks:!1}))},save:()=>null,icon:r})})()})();